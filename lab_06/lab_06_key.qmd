#lab_07 
Rob Wells, Aug 16, 2022

## About this lab

To complete this lab, you need to:
* write code in empty codeblocks provided to answer questions included (look for **Q**).
* write out the answer in the form of a complete sentence in the space given (look for **A**).

When you are finished, commit changes and push to your personal GitHub repo, then submit the URL to this document on ELMS.

## Load libraries and establish settings
**Task**: Load janitor and the tidyverse
```{r}
# Turn off scientific notation
options(scipen=999)

# Load the tidyverse, janitor
library(tidyverse)
library(janitor)

```

## Motivating questions

Are there race or gender-based disparities among the ranks of athletic directors in college athletics?  

We'll answer two questions, then visualize the data. 

## Load data

We are using NCAA demographics data showing race and gender for athletic directors and student athletes. It is available here: https://www.ncaa.org/sports/2018/12/13/ncaa-demographics-database.aspx?id=1729

**Task** Load the data from the folder.
```{r}
demographics <- read_csv("ncaa_athletic_dirs.csv")

```

**Q1** Visit the source link for the data. Write a paragraph explaining where the data came from, how it was collected and any potential shortcomings in what it measures that could limit analysis. 

**A1**
The data includes self-reported data from active NCAA members schools and their demographics forms. It seems to be collected on a voluntary basis. Since some staff members have multiple roles, the total percentages reflect the number of positions instead of the total number of individuals. A possible shortcoming is it does not specify if individuals checking off the two or more race category also check off each race where they identify.

#####

**Q2** How did the number of white male athletic directors in 2021 compare to the number of male athletic directors from other racial categories included in the data? 

* Write a sentence that could be dropped into a news story showing the difference. * Output a table showing the difference you identify.
* Output a basic column chart showing the difference you identify. 
  * Use a headline that explains what the chart shows.
  * Include source information
  * Use Title Case axis labels

**A2**

```{r}

race_athdirects <- demographics %>%
  filter(year==2021) %>% 
  filter(str_detect(race_sex,"^male")) %>%
  mutate(white_other = ifelse(race_sex == "male_white", "white","other")) %>%
  group_by(white_other) %>%
  summarise(
    total = sum(count)
  )

race_athdirects





race_athdirects_j_c <- demographics %>%
  filter(year==2021) %>%
  filter(str_detect(race_sex,"^male"))

race_athdirects_j_c %>%
  ggplot() +
  geom_bar(aes(y=count, x=race_sex, fill=race_sex),stat="identity") +
  labs(
    title = "More than 8 in 10 athletic directors are white",
    x = "Demographic group",
    y = "Number of athletic directors",
    caption = "Source: self-reported data from NCAA"
  ) + 
  theme(
    legend.position="none"
  )
         



```

#####

**Q3.** How has the number of black female athletic directors changed over the period covered by the data, compared to white female athletic directors?  

* Write a sentence that could be dropped into a news story showing the change. 
* Output a table showing the change you identify.
* Output a basic line chart showing the difference you identify. 
  * Use a headline that explains what the chart shows.
  * Include source information
  * Use Title Case axis labels

**A3**


```{r}

female <- demographics %>%
  select(year, race_sex, count) %>%
  filter(str_detect(race_sex,"female_white|female_black")) %>%
  arrange(desc(count)) %>%
  pivot_wider(names_from=race_sex,values_from=count)

female %>%
  ggplot() +
  geom_line(aes(x=year,y=female_white), color="purple") +
  geom_line(aes(x=year,y=female_black), color="green") +
  labs(
    title="White female athletic directors have steadily and substantially\noutnumbered their Black counterparts since 2012",
    caption="source: NCAA demographics database 2020-2021",
    x = "Year",
    y = "Number of athletic directors"
  )

```

#####

**Q4** Develop a question and then operationalize that question that puts in context the finding from question 2. 

* Write a sentence that could be dropped into a news story with your finding. 
* Output a table showing important information that you choose to contexualize the finding.
* Output a chart displaying your finding. 
  * Use a headline that explains what the chart shows.
  * Include source information
  * Use Title Case axis labels

**A4**

```{r}

# any major changes across NCAA athletic directors over same observed period, 2012-2021?

all_race_gender <- demographics %>%
  select(year,race_sex,count) %>%
  group_by(year) %>%
  pivot_wider(names_from=race_sex,values_from=count) 

all_race_gender

demographics %>%
  filter(!str_detect(race_sex,"^male_white")) %>%
  ggplot(aes(x=year,y=count)) +
  geom_line(aes(color=race_sex))
  
demographics %>%
  filter(year == 2021) %>%
  ggplot(aes(x=race_sex,y=count, fill=race_sex)) +
  geom_bar(stat="identity") + 
  theme(axis.text.x = element_text(angle = 45, hjust=1))

# how has the gap in the number of white and black female athletic directors change over time.  

female <- demographics %>%
  select(year, race_sex, count) %>%
  filter(str_detect(race_sex,"female_white|female_black")) %>%
  arrange(desc(count)) %>%
  pivot_wider(names_from=race_sex,values_from=count) %>%
  mutate(difference = female_white-female_black) %>%
  mutate(ratio = female_white/female_black)

# in the last decade, gap between no lower than 7 to 1
female %>%
  ggplot() +
  geom_bar(aes(x=year,y=ratio), stat="identity") +
  geom_line(aes(x=year,y=ratio))


```